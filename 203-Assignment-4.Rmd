---
title: "ESM 203 Assignment 4"
author: "Robert Saldivar"
date: "December 5, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Part 0 Load Packages
```{r, include=FALSE}
library(tidyverse)
```


Part 1 Creating A Statistical Model
```{r sample random number generator, include=FALSE}

x <- rnorm(1000, mean = 0, sd = 1) %>%
  as.data.frame()

```

```{r}
#Creating a sample of tide ranges

tide_range <- rnorm(10000, mean = 2.5, sd = 3) %>%
  as.data.frame

colnames(tide_range) <- c("tide_range")
#Creating a random set of numbers for tide ranges around a mean of 2.5 and a sd of 3


```

```{r}
#inital data exploration

tide_range_hist <- ggplot(tide_range, aes(x=tide_range)) +
  geom_histogram(bins=43, fill = "blue", color="black") +
  theme_classic()
tide_range_hist #creating a histogram to view normal distribution of tide range

tide_range_qq <- ggplot(tide_range, aes(sample=tide_range)) +
  geom_qq()
tide_range_qq #creating a qq plot to view normal distribution of tide range

```


```{r}
# Counting the amount of floods and proportion under normal conditions

tide_range_flood <- tide_range %>%
  mutate(Flood = ifelse(tide_range > 7.5, "Flood", "No Flood")) %>%
  count(Flood, Flood) %>%
  spread(Flood, n) # Creating a count of the number of time that the water is high enough to flood assuming over 7.5 m causes a significant flood.

Flood_Prop <- round(prop.table(as.matrix(tide_range_flood), 1), 3) #Creates a proportion table of the number of floods vs the number of no floods

#The Risk of flood under normal conditions is 4.8%

```

```{r}
# Counting the amount of floods and proportions with a storm surge of 1m

storm_surge1 <- tide_range %>%
  mutate(Flood = ifelse(tide_range > 6.5, "Flood", "No Flood")) %>%
  count(Flood, Flood) %>%
  spread(Flood, n)

storm_surge1_prop <- round(prop.table(as.matrix(storm_surge1), 1), 3)

```

```{r}
# Counting the amount of floods and proportions with a storm surge of 2m

storm_surge2 <- tide_range %>%
  mutate(Flood = ifelse(tide_range > 5.5, "Flood", "No Flood")) %>%
  count(Flood, Flood) %>%
  spread(Flood, n)

storm_surge2_prop <- round(prop.table(as.matrix(storm_surge2), 1), 3)

```

```{r}
# Counting the amount of floods and proportions with a storm surge of 3m

storm_surge3 <- tide_range %>%
  mutate(Flood = ifelse(tide_range > 4.5, "Flood", "No Flood")) %>%
  count(Flood, Flood) %>%
  spread(Flood, n)

storm_surge3_prop <- round(prop.table(as.matrix(storm_surge3), 1), 3)

```

